{% extends "base.html" %}

{% block content %}
<div class="card shadow-sm">
  <div class="card-header d-flex justify-content-between align-items-center">
    <h5 class="mb-0">Employees</h5>

    <div>
      <a href="/download/csv" class="btn btn-success btn-sm me-2">Download CSV</a>
      <a href="/download/excel" class="btn btn-success btn-sm">Download Excel</a>
    </div>
  </div>

  <div class="card-body">

    <input id="searchBox" class="form-control mb-3" placeholder="Search by name, dept, designation">

    <div class="table-responsive">
      <table id="empTable" class="table table-striped table-hover align-middle">
        <thead class="table-light">
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Age</th>
            <th>Department</th>
            <th>Designation</th>
            <th>Salary</th>
            <th>Experience</th>
            <th>Action</th>
          </tr>
        </thead>

        <tbody>
          {% for emp in employees %}
          <tr>
            <td>{{ emp.id }}</td>
            <td>{{ emp.name }}</td>
            <td>{{ emp.age }}</td>
            <td>{{ emp.dept }}</td>
            <td>{{ emp.designation }}</td>
            <td>{{ emp.salary }}</td>
            <td>{{ emp.experience }}</td>
            <td>
              <a href="/edit/{{ emp.id }}" class="btn btn-primary btn-sm">Edit</a>

              <form action="/delete/{{ emp.id }}" method="post" style="display:inline;" onclick="return confirm('Delete this employee?')">
                <button class="btn btn-danger btn-sm">Delete</button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>

      </table>
    </div>
  </div>
</div>

<script>
document.getElementById('searchBox').addEventListener('input', function() {
  let q = this.value.toLowerCase();

  document.querySelectorAll('#empTable tbody tr').forEach(row => {
    let text = row.innerText.toLowerCase();
    row.style.display = text.includes(q) ? '' : 'none';
  });
});
</script>

{% endblock %}
